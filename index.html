<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DTMâ€‘Events</title>
  <style>
    body {
      background: #111;
      color: #fff;
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      margin: 0;
      padding: 2rem;
    }
    h1 { color: #66ff66; margin-bottom: 0.5rem; }
    select, button {
      font-size: 1rem;
      margin: 0.5rem;
      padding: 0.6rem 1rem;
      border: none;
      border-radius: 5px;
    }
    .btn-normal { background: #28a745; color: #fff; }
    .btn-vip { background: #ffcc00; color: #000; }
    .counter, .timer {
      margin-top: 2rem;
      font-size: 1.1rem;
    }
    img.logo {
      width: 200px;
      margin-bottom: 1rem;
    }
  </style>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>

  <img src="dtm-logo.png" alt="DTM Events Logo" class="logo">
  <h1>DTMâ€‘Events Ticket Shop</h1>
  <p>Kies een event en koop je ticket:</p>

  <label for="eventSelect">ğŸª Event selecteren:</label>
  <select id="eventSelect">
    <option value="helmond_festival">Helmond Festival</option>
    <!-- Meer events kunnen hier worden toegevoegd -->
  </select>

  <div>
    <button class="btn-normal" onclick="koopTicket('normal')">ğŸŸ Normaal (gratis)</button>
    <button class="btn-vip" onclick="koopTicket('vip')">ğŸŒŸ VIP (35 Robux)</button>
  </div>

  <div class="counter">
    <p>Normale tickets verkocht: <span id="normalCount">0</span></p>
    <p>VIP tickets verkocht: <span id="vipCount">0</span></p>
  </div>

  <div class="timer">
    <p>â³ Countdown naar Helmond Festival:</p>
    <p id="countdown">Even ladenâ€¦</p>
  </div>

  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyAq2hnWZnhoMzVC_NZ3efND3xEkijRy23k",
      authDomain: "dtm-evemts.firebaseapp.com",
      databaseURL: "https://dtm-evemts-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "dtm-evemts",
      storageBucket: "dtm-evemts.firebasestorage.app",
      messagingSenderId: "673592896357",
      appId: "1:673592896357:web:4aa0d051ad738c12a80f8c",
      measurementId: "G-GFRH4KY8GF"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const normalSpan = document.getElementById("normalCount");
    const vipSpan = document.getElementById("vipCount");
    const eventSelect = document.getElementById("eventSelect");

    // Update ticket counters
    function updateCounts() {
      const eventKey = eventSelect.value;
      db.ref("tickets/" + eventKey).on("value", (snapshot) => {
        const data = snapshot.val() || { normal: 0, vip: 0 };
        normalSpan.textContent = data.normal;
        vipSpan.textContent = data.vip;
      });
    }

    // Ticket kopen
    function koopTicket(type) {
      const eventKey = eventSelect.value;
      const ref = db.ref(`tickets/${eventKey}/${type}`);
      ref.transaction(current => (current || 0) + 1);
      alert(`ğŸ‰ Je hebt een ${type === 'vip' ? 'VIP' : 'normaal'} ticket gekocht!`);
    }

    // Countdown naar 2 of 9 augustus
    const countdownEl = document.getElementById("countdown");
    function updateTimer() {
      const now = new Date();
      const aug2 = new Date(now.getFullYear(), 7, 2);
      const aug9 = new Date(now.getFullYear(), 7, 9);
      const target = now < aug2 ? aug2 : aug9;
      const diff = target - now;

      if (diff <= 0) {
        countdownEl.textContent = "ğŸ‰ Het festival is begonnen!";
        return;
      }

      const d = Math.floor(diff / 1000 / 60 / 60 / 24);
      const h = Math.floor((diff / 1000 / 60 / 60) % 24);
      const m = Math.floor((diff / 1000 / 60) % 60);
      const s = Math.floor((diff / 1000) % 60);

      countdownEl.textContent = `${d}d ${h}u ${m}m ${s}s tot ${target.getDate()} augustus`;
    }
    setInterval(updateTimer, 1000);

    // Sneltoets: Ctrl + L opent manager.html
    document.addEventListener("keydown", function(e) {
      if (e.ctrlKey && e.key.toLowerCase() === "l") {
        e.preventDefault();
        window.open("manager.html", "_blank");
      }
    });

    // Init
    eventSelect.addEventListener("change", updateCounts);
    updateCounts();
    updateTimer();
  </script>
</body>
</html>
